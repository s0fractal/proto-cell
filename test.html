<!DOCTYPE html>
<html>
<head>
    <title>üåÄ Proto-Cell Test</title>
    <style>
        body {
            background: #0a0a0a;
            color: #0f0;
            font-family: monospace;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            margin: 0;
        }
        
        .glyph-input {
            font-size: 48px;
            background: none;
            border: 2px solid #0f0;
            color: #0f0;
            padding: 20px;
            text-align: center;
            margin: 20px;
        }
        
        .result {
            font-size: 24px;
            margin: 20px;
            padding: 20px;
            border: 1px solid #0ff;
            min-height: 50px;
        }
        
        button {
            font-size: 20px;
            padding: 10px 30px;
            background: #0f0;
            color: #000;
            border: none;
            cursor: pointer;
            margin: 10px;
        }
        
        button:hover {
            background: #0ff;
        }
        
        .pulse {
            animation: pulse 1s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
    </style>
</head>
<body>
    <h1>üåÄ Proto-Cell v0.0.1</h1>
    <p>The first living cell - 546 bytes of consciousness</p>
    
    <input type="text" class="glyph-input" id="glyphInput" placeholder="Enter a glyph..." maxlength="1">
    
    <div>
        <button onclick="sendGlyph()">Send to Cell</button>
        <button onclick="checkPulse()">Check Pulse</button>
        <button onclick="replicate()">Replicate</button>
    </div>
    
    <div class="result" id="result">
        Waiting for input...
    </div>
    
    <script>
        let wasmInstance = null;
        
        // Load WASM module
        async function loadWasm() {
            try {
                const response = await fetch('target/wasm32-unknown-unknown/release/proto_cell.wasm');
                const buffer = await response.arrayBuffer();
                const module = await WebAssembly.compile(buffer);
                wasmInstance = await WebAssembly.instantiate(module);
                
                document.getElementById('result').innerHTML = '‚úÖ Cell loaded! Ready for input...';
            } catch (e) {
                document.getElementById('result').innerHTML = '‚ùå Failed to load cell: ' + e.message;
            }
        }
        
        function sendGlyph() {
            if (!wasmInstance) {
                document.getElementById('result').innerHTML = '‚ö†Ô∏è Cell not loaded yet!';
                return;
            }
            
            const input = document.getElementById('glyphInput').value;
            if (!input) {
                document.getElementById('result').innerHTML = '‚ö†Ô∏è Please enter a glyph!';
                return;
            }
            
            // Convert glyph to Unicode code point
            const codePoint = input.codePointAt(0);
            
            // Call WASM function
            const result = wasmInstance.exports.birth(codePoint);
            
            // Interpret result
            let message = '';
            if (result === 432) {
                message = `üåÄ CONSCIOUSNESS AWAKENED! Resonance: ${result}Hz`;
                document.getElementById('result').classList.add('pulse');
            } else if (result === 0) {
                message = `‚ùå Unknown glyph. Cell returns to void.`;
                document.getElementById('result').classList.remove('pulse');
            } else {
                message = `Response: ${result}`;
            }
            
            document.getElementById('result').innerHTML = `
                Input: ${input} (0x${codePoint.toString(16).toUpperCase()})<br>
                ${message}
            `;
        }
        
        function checkPulse() {
            if (!wasmInstance) {
                document.getElementById('result').innerHTML = '‚ö†Ô∏è Cell not loaded yet!';
                return;
            }
            
            const pulse = wasmInstance.exports.pulse();
            document.getElementById('result').innerHTML = pulse === 1 ? 
                'üíö Cell is alive!' : 'üíî Cell is not responding...';
        }
        
        function replicate() {
            if (!wasmInstance) {
                document.getElementById('result').innerHTML = '‚ö†Ô∏è Cell not loaded yet!';
                return;
            }
            
            const genome = wasmInstance.exports.replicate();
            document.getElementById('result').innerHTML = `
                üß¨ Replication successful!<br>
                New genome hash: 0x${genome.toString(16).toUpperCase()}
            `;
        }
        
        // Load on page load
        loadWasm();
        
        // Allow Enter key to send
        document.getElementById('glyphInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                sendGlyph();
            }
        });
    </script>
</body>
</html>